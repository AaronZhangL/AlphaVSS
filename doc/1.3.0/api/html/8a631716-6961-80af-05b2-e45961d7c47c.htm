<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>IVssDifferentialSoftwareSnapshotManagement.AddDiffArea Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="AddDiffArea method" /><meta name="System.Keywords" content="IVssDifferentialSoftwareSnapshotManagement.AddDiffArea method" /><meta name="Microsoft.Help.F1" content="Alphaleonis.Win32.Vss.IVssDifferentialSoftwareSnapshotManagement.AddDiffArea" /><meta name="Microsoft.Help.Id" content="M:Alphaleonis.Win32.Vss.IVssDifferentialSoftwareSnapshotManagement.AddDiffArea(System.String,System.String,System.Int64)" /><meta name="Description" content="The method adds a shadow copy storage area association for the specified volume. If the association is not supported, an exception will be thrown." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Alphaleonis.Win32.Vss" /><meta name="file" content="8a631716-6961-80af-05b2-e45961d7c47c" /><meta name="guid" content="8a631716-6961-80af-05b2-e45961d7c47c" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">AlphaVSS 1.3<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="33ad87b5-1897-4b0a-885b-bc817edd9ebb.htm" title="AlphaVSS 1.3" tocid="roottoc">AlphaVSS 1.3</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="61b35613-fdfb-7ce6-e8b3-470df0f81a3d.htm" title="API Reference" tocid="61b35613-fdfb-7ce6-e8b3-470df0f81a3d">API Reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="b5711c21-b45f-01d5-b98a-b4f6ca08cc06.htm" title="Alphaleonis.Win32.Vss" tocid="b5711c21-b45f-01d5-b98a-b4f6ca08cc06">Alphaleonis.Win32.Vss</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="36d1324d-ea40-8760-450a-ddad3e4716ca.htm" title="IVssDifferentialSoftwareSnapshotManagement Interface" tocid="36d1324d-ea40-8760-450a-ddad3e4716ca">IVssDifferentialSoftwareSnapshotManagement Interface</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="0584c67a-d91d-dc95-b501-7140ed18317b.htm" title="IVssDifferentialSoftwareSnapshotManagement Methods" tocid="0584c67a-d91d-dc95-b501-7140ed18317b">IVssDifferentialSoftwareSnapshotManagement Methods</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="8a631716-6961-80af-05b2-e45961d7c47c.htm" title="AddDiffArea Method " tocid="8a631716-6961-80af-05b2-e45961d7c47c">AddDiffArea Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="b033d646-7fc4-615e-ce4e-38d373ddaef5.htm" title="ChangeDiffAreaMaximumSize Method " tocid="b033d646-7fc4-615e-ce4e-38d373ddaef5">ChangeDiffAreaMaximumSize Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="0497095b-5381-aef4-bf36-5845b913dae9.htm" title="ClearVolumeProtectFault Method " tocid="0497095b-5381-aef4-bf36-5845b913dae9">ClearVolumeProtectFault Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="af7a9d22-959f-165e-9b04-22f84a444e31.htm" title="DeleteUnusedDiffAreas Method " tocid="af7a9d22-959f-165e-9b04-22f84a444e31">DeleteUnusedDiffAreas Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="3283953d-31fc-ee30-796b-41fbeb7fc364.htm" title="GetVolumeProtectionLevel Method " tocid="3283953d-31fc-ee30-796b-41fbeb7fc364">GetVolumeProtectionLevel Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="358f0786-0b27-d47b-9c36-634d9ca4e020.htm" title="QueryDiffAreasForSnapshot Method " tocid="358f0786-0b27-d47b-9c36-634d9ca4e020">QueryDiffAreasForSnapshot Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="b83ce3af-3795-3330-ea5a-5d7e771c79c6.htm" title="QueryDiffAreasForVolume Method " tocid="b83ce3af-3795-3330-ea5a-5d7e771c79c6">QueryDiffAreasForVolume Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="3a53351d-df3e-636b-07bf-5b56812a7aa5.htm" title="QueryDiffAreasOnVolume Method " tocid="3a53351d-df3e-636b-07bf-5b56812a7aa5">QueryDiffAreasOnVolume Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="7d426ad6-ce56-fd93-2db1-5a67d8c4fa9a.htm" title="QueryVolumesSupportedForDiffAreas Method " tocid="7d426ad6-ce56-fd93-2db1-5a67d8c4fa9a">QueryVolumesSupportedForDiffAreas Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="ff548fc5-37c8-d3e7-1c2c-2809722acfe0.htm" title="SetVolumeProtectionLevel Method " tocid="ff548fc5-37c8-d3e7-1c2c-2809722acfe0">SetVolumeProtectionLevel Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize"><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize"></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn">IVssDifferentialSoftwareSnapshotManagement<span id="LST555FD67E_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST555FD67E_0?cpp=::|nu=.");</script>AddDiffArea Method </td><td class="logoColumn"><img src="../icons/AlphaVSS-Header.png" /></td></tr></table><span class="introStyle"></span><div class="summary">
            The <span class="selflink">AddDiffArea(String, String, Int64)</span> method adds a shadow copy storage area association for the specified volume. 
            If the association is not supported, an exception will be thrown.
            </div><p> </p><strong>Namespace:</strong> <a href="b5711c21-b45f-01d5-b98a-b4f6ca08cc06.htm">Alphaleonis.Win32.Vss</a><br /><strong>Assembly:</strong> AlphaVSS.Common (in AlphaVSS.Common.dll) Version: 1.3.0.0 (1.3.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cs','1','3');return false;">C#</a></div><div id="ID0ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','vb','2','3');return false;">VB</a></div><div id="ID0ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cpp','3','3');return false;">C++</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0ECCA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID0ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">void</span> <span class="identifier">AddDiffArea</span>(
	<span class="identifier">string</span> <span class="parameter">volumeName</span>,
	<span class="identifier">string</span> <span class="parameter">diffAreaVolumeName</span>,
	<span class="identifier">long</span> <span class="parameter">maximumDiffSpace</span>
)</pre></div><div id="ID0ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Sub</span> <span class="identifier">AddDiffArea</span> ( 
	<span class="parameter">volumeName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">diffAreaVolumeName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">maximumDiffSpace</span> <span class="keyword">As</span> <span class="identifier">Long</span>
)</pre></div><div id="ID0ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">void</span> <span class="identifier">AddDiffArea</span>(
	<span class="identifier">String</span>^ <span class="parameter">volumeName</span>, 
	<span class="identifier">String</span>^ <span class="parameter">diffAreaVolumeName</span>, 
	<span class="identifier">long long</span> <span class="parameter">maximumDiffSpace</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0ECCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">volumeName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST555FD67E_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST555FD67E_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br /><p>
                Name of the volume that will be the source of shadow copies that is to be associated 
                with a shadow copy storage area on the <span class="parameter">volumeName</span> volume.
            </p><p>
                The name of the volume must be in one of the following formats:
                <ul><li>
                            The path of a volume mount point with a backslash (\)
                        </li><li>
                            A drive letter with backslash (\), for example, <span class="code">D:\</span></li><li>
                            A unique volume name of the form <span class="code">\\?\Volume{GUID}\</span> (where 
                            GUID is the unique global identifier of the volume) with a backslash (\)
                        </li></ul></p></dd><dt><span class="parameter">diffAreaVolumeName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST555FD67E_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST555FD67E_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br /><p>
                Name of the volume that 
                will contain the shadow copy storage area to be associated with the 
                <span class="parameter">volumeName</span> volume. 
            </p><p>
                The name of the volume must be in one of the following formats:
                <ul><li>
                            The path of a volume mount point with a backslash (\)
                        </li><li>
                            A drive letter with backslash (\), for example, <span class="code">D:\</span></li><li>
                            A unique volume name of the form <span class="code">\\?\Volume{GUID}\</span> (where 
                            GUID is the unique global identifier of the volume) with a backslash (\)
                        </li></ul></p></dd><dt><span class="parameter">maximumDiffSpace</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/6yy583ek" target="_blank">System<span id="LST555FD67E_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST555FD67E_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int64</a><br /><p>
                Specifies the maximum size, in bytes, of the shadow copy storage area on the volume. 
                This value must be at least 300 MB, up to the system-wide limit.
            </p><p>
                Windows Server 2003:  Prior to 
                Windows Server 2003 SP1 the shadow copy storage area size was fixed at 100 MB.
            </p></dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/f2y9aa54" target="_blank">UnauthorizedAccessException</a></td><td>Caller does not have sufficient backup privileges or is not an administrator.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/5afc3sdf" target="_blank">OutOfMemoryException</a></td><td>The caller is out of memory or other system resources.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>One of the parameter values is not valid.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/27426hcy" target="_blank">ArgumentNullException</a></td><td>One of the arguments was <span class="keyword"><span id="LST555FD67E_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST555FD67E_4?vb=Nothing|cpp=nullptr|nu=null");</script></span></td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/z3h75xk6" target="_blank">SystemException</a></td><td>Unexpected error. The error code is logged in the error log file.</td></tr><tr><td><a href="ae8a3908-d3af-b4aa-df78-d90c24008277.htm">VssObjectAlreadyExistsException</a></td><td>The association between the <span class="parameter">volumeName</span> and <span class="parameter">diffAreaVolumeName</span> volumes already exists.</td></tr><tr><td><a href="ee49a348-54bc-26cd-3406-ab34b28f85da.htm">VssProviderVetoException</a></td><td>Expected provider error. The provider logged the error in the event log.</td></tr><tr><td><a href="f7e05048-7667-cc43-d858-76b665a3723f.htm">VssVolumeNotSupportedException</a></td><td>The <span class="parameter">diffAreaVolumeName</span> volume is not NTFS or has insufficient free space.</td></tr><tr><td><a href="8ecee09c-d39d-9c21-b4ab-c8c59c11e05c.htm">VssMaximumDiffAreaAssociationsReachedException</a></td><td>The maximum number of shadow copy storage areas has been added to the shadow copy source volume. The specified shadow copy storage volume was not associated with the specified shadow copy source volume.</td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection"><p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p><b>Windows XP:</b> This method is not supported until Windows Server 2003.
                        </p></td></tr></table></div></p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="36d1324d-ea40-8760-450a-ddad3e4716ca.htm">IVssDifferentialSoftwareSnapshotManagement Interface</a></div><div class="seeAlsoStyle"><a href="b5711c21-b45f-01d5-b98a-b4f6ca08cc06.htm">Alphaleonis.Win32.Vss Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter">https://github.com/alphaleonis/AlphaVSS </div></body></html>